import{R as f,i as q,k as K,l as M,m as O,n as F,p as P,o as A,q as C,u as Q,r as w,j as e,H as X,L as I,b as Y,d as Z,f as ee,h as $}from"./index-Kwye6Ie_.js";import{u as se}from"./index.esm-BMQL-J4v.js";function V(){const i=`${`/${f(q)}`}/Pictures`,a=K();M(O);const c=F(P),m=F(A),o=C(P),s=C(A);return{register:b,getAll:v,getById:g,update:N,delete:t,resetPictures:o,resetPicture:s};function b(n){const{Id:r,...l}=n;return a.post(i,l)}function v(){return a.get(i).then(c)}function g(n){return a.get(`${i}/${n}`).then(r=>{if(!r)throw new Error("Picture not found");return m(r),r})}function N(n,r){return a.put(`${i}/${n}`,r).then(l=>l)}function t(n){return c(r=>r.map(l=>l.id===n?{...l,isDeleting:!0}:l)),a.delete(`${i}/${n}`).then(()=>{c(r=>r.filter(l=>l.id!==n))}).catch(r=>{throw c(l=>l.map(h=>h.id===n?{...h,isDeleting:!1}:h)),r})}}function te(){const j=Q().pathname,i=f(P),a=V(),o=`${`/${f(q)}`}/Pictures`;return w.useEffect(()=>(a.getAll(),a.resetPictures),[]),e.jsxs("div",{children:[e.jsxs(X,{children:[e.jsx("title",{children:"Pictures"}),e.jsx("meta",{property:"robots",content:"noindex","data-react-helmet":"true"})]}),e.jsx("h1",{children:"Pictures"}),e.jsx(I,{to:`${j}/add`,className:"btn btn-sm btn-success mb-2",children:"Add Picture"}),e.jsxs("table",{className:"table table-striped",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"5%"},children:"Id"}),e.jsx("th",{style:{width:"5%"},children:"Title"}),e.jsx("th",{style:{width:"5%"},children:"Type"}),e.jsx("th",{style:{width:"5%"},children:"Hight"}),e.jsx("th",{style:{width:"5%"},children:"Width"}),e.jsx("th",{style:{width:"10%"},children:"Text"}),e.jsx("th",{style:{width:"10%"},children:"Author"}),e.jsx("th",{style:{width:"10%"},children:"Url"}),e.jsx("th",{style:{width:"10%"},children:"Icon"}),e.jsx("th",{style:{width:"10%"}}),e.jsx("th",{style:{width:"30%"},children:"Image"})]})}),e.jsxs("tbody",{children:[i==null?void 0:i.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.id}),e.jsx("td",{children:s.imageTitle}),e.jsx("td",{children:s.imageType}),e.jsx("td",{children:s.imageHight}),e.jsx("td",{children:s.imageWidth}),e.jsx("td",{children:s.text}),e.jsx("td",{children:s.author}),e.jsx("td",{children:s.imageUrl}),e.jsx("td",{children:e.jsx("img",{src:`${o}/image${s.id}.jpg`,alt:"",height:"80px"})}),e.jsxs("td",{style:{whiteSpace:"nowrap"},children:[e.jsx(I,{to:`${j}/edit/${s.id}`,className:"btn btn-sm btn-primary mr-1",children:"Edit"}),e.jsx("button",{onClick:()=>a.delete(s.id),className:"btn btn-sm btn-danger",style:{width:"60px"},disabled:s.isDeleting,children:s.isDeleting?e.jsx("span",{className:"spinner-border spinner-border-sm"}):e.jsx("span",{children:"Delete"})})]}),e.jsx("td",{children:s.image})]},s.id)),!i&&e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center",children:e.jsx("span",{className:"spinner-border spinner-border-lg align-center"})})})]})]})]})}function B({history:u}){var T,k,U,_,D,E,H,L,S,W;const i=Y().id,a={add:!i,edit:!!i},c=V(),m=Z(),o=f(A),{register:s,handleSubmit:b,setValue:v,reset:g,formState:N}=se(),{errors:t,isSubmitting:n}=N;w.useEffect(()=>(a.edit&&c.getById(i),c.resetPicture),[]),w.useEffect(()=>{a.edit&&o&&g(o)},[o]);function r(d){return a.add?l(d):h(i,d)}function l(d){return c.register(d).then(()=>{u.push("/picture"),m.success("Picture added")})}function h(d,x){return c.update(d,x).then(()=>{u.push("/picture"),m.success("Picture updated")})}const z=d=>new Promise((x,y)=>{const p=new FileReader;p.readAsDataURL(d),p.onload=()=>{x(p.result)},p.onerror=J=>{y(J)}}),G=async d=>{const x=d.target.files[0],y=await z(x);v("imageData",y.slice(23))},R=a.edit&&!o;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"card m-3",children:[e.jsx("h1",{children:a.add?"Add Picture":"Edit Picture"}),e.jsxs("div",{className:"card-body",children:[!R&&e.jsxs("form",{onSubmit:b(r),children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Image"}),e.jsx("input",{id:"image",type:"text",...s("image"),className:`form-control ${t.image?"is-invalid":""}`}),e.jsx("div",{className:"invalid-feedback",children:`${(T=t.image)==null?void 0:T.message}`})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Title"}),e.jsx("input",{id:"imageTitle",type:"text",...s("imageTitle"),className:`form-control ${t.imageTitle?"is-invalid":""}`}),e.jsx("div",{className:"invalid-feedback",children:`${(k=t.imageTitle)==null?void 0:k.message}`})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Type"}),e.jsx("input",{id:"imageType",type:"text",...s("imageType"),className:`form-control ${t.imageType?"is-invalid":""}`}),e.jsx("div",{className:"invalid-feedback",children:`${(U=t.imageType)==null?void 0:U.message}`})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Hight"}),e.jsx("input",{id:"imageHight",type:"text",...s("imageHight"),className:`form-control ${t.imageHight?"is-invalid":""}`}),e.jsx("div",{className:"invalid-feedback",children:`${(_=t.imageHight)==null?void 0:_.message}`})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Width"}),e.jsx("input",{id:"text:",type:"text",...s("imageWidth"),className:`form-control ${t.imageWidth?"is-invalid":""}`}),e.jsx("div",{className:"invalid-feedback",children:`${(D=t.imageWidth)==null?void 0:D.message}`})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Text"}),e.jsx("input",{id:"text:",type:"text",...s("text"),className:`form-control ${t.text?"is-invalid":""}`}),e.jsx("div",{className:"invalid-feedback",children:`${(E=t.text)==null?void 0:E.message}`})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Author"}),e.jsx("input",{id:"author",type:"text",...s("author"),className:`form-control ${t.author?"is-invalid":""}`}),e.jsx("div",{className:"invalid-feedback",children:`${(H=t.author)==null?void 0:H.message}`})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Url"}),e.jsx("input",{id:"imageUrl",type:"text",...s("imageUrl"),className:`form-control ${t.imageUrl?"is-invalid":""}`}),e.jsx("div",{className:"invalid-feedback",children:`${(L=t.imageUrl)==null?void 0:L.message}`})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Icon"}),e.jsx("input",{id:"imageIcon",type:"text",...s("imageIcon"),className:`form-control ${t.imageIcon?"is-invalid":""}`}),e.jsx("div",{className:"invalid-feedback",children:`${(S=t.imageIcon)==null?void 0:S.message}`})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("button",{type:"submit",disabled:n,className:"btn btn-primary mr-2",children:[n&&e.jsx("span",{className:"spinner-border spinner-border-sm mr-1"}),"Save"]}),e.jsx("button",{onClick:()=>g(o),type:"button",disabled:n,className:"btn btn-secondary",children:"Reset"}),e.jsx(I,{to:"/config",className:"btn btn-link",children:"Cancel"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"ImageData"}),e.jsx("input",{id:"imageData",type:"text",...s("imageData"),className:`form-control ${t.imageData?"is-invalid":""}`}),e.jsx("img",{src:`/Pictures/image${i}.jpg`,alt:"",height:"180px"}),e.jsx("div",{className:"invalid-feedback",children:`${(W=t.imageData)==null?void 0:W.message}`}),e.jsx("input",{type:"file","aria-label":"Image",name:"myFile",accept:".jpeg, .png, .jpg",onChange:d=>G(d)})]})]}),R&&e.jsx("div",{className:"text-center p-3",children:e.jsx("span",{className:"spinner-border spinner-border-lg align-center"})})]})]})})}function ne(){return e.jsx("div",{className:"p-4",children:e.jsx("div",{className:"container",children:e.jsxs(ee,{children:[e.jsx($,{exact:!0,path:"/",element:e.jsx(te,{})}),e.jsx($,{path:"/add",element:e.jsx(B,{})}),e.jsx($,{path:"/edit/:id",element:e.jsx(B,{})})]})})})}export{ne as default};
